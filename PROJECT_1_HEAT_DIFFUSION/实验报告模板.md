# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：** [马翔宇] 

**学号：** [20231050170] 

**完成日期：** [2025.6.11]

## 1. 实验目的

通过实现显式差分法求解一维热传导方程，掌握偏微分方程数值解法的基本原理，深入理解显式差分法的稳定性条件和精度特点，学会分析数值方法的误差和稳定性。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率， $C$ 是比热容， $\rho$ 是密度

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

[描述显式差分法的基本思想、离散化过程和稳定性条件]
显式差分法通过对时间和空间进行离散化，将偏微分方程转化为递推公式。具体步骤如下：
1. **空间离散**：将铝棒长度 $L$ 划分为 $N_x$ 个网格，步长 $\Delta x = L/(N_x-1)$
2. **时间离散**：将模拟时间划分为 $N_t$ 个时间步，步长 $\Delta t$
3. **差分近似**：
   - 时间一阶导数：$\frac{\partial T}{\partial t} \approx \frac{T_i^{j+1} - T_i^j}{\Delta t}$
   - 空间二阶导数：$\frac{\partial^2 T}{\partial x^2} \approx \frac{T_{i+1}^j - 2T_i^j + T_{i-1}^j}{(\Delta x)^2}$
4. **递推公式**：
   $$T_i^{j+1} = (1-2r)T_i^j + r(T_{i+1}^j + T_{i-1}^j)$$
   其中稳定性参数 $r = \frac{\alpha\Delta t}{(\Delta x)^2}$，需满足 $r \leq 0.5$ 以保证数值稳定性。
### 2.2 关键代码片段
```python

def basic_heat_diffusion():
    r = D*dt/(dx**2)
    print(f"任务1 - 稳定性参数 r = {r}")
    
    u = np.zeros((Nx, Nt))
    u[:, 0] = 100  # 初始条件
    u[0, :] = 0    # 左边界
    u[-1, :] = 0   # 右边界
    
    # 显式差分迭代
    for j in range(Nt-1):
        u[1:-1, j+1] = (1-2*r)*u[1:-1, j] + r*(u[2:, j] + u[:-2, j])
    
    return u
```

## 3. 实验结果

### 3.1 显式差分法数值解

[展示显式差分法的温度分布随时间位置演化的3D图]
![image](https://github.com/user-attachments/assets/61b12c76-90cc-4719-b2cc-389da76ef398)

### 3.2 解析解
**解析解公式：**

$$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin(k_nx)e^{-k_n^2Dt}$$

其中 $k_n = n\pi/L$， $T_0=100$ K

[展示解析解的温度分布随时间位置演化的3D图]

![image](https://github.com/user-attachments/assets/7865b4b9-4932-4df9-ba11-3f2d0e746cfe)

### 3.3 稳定性分析

**稳定性条件：** r = DΔt/Δx² ≤ 0.5

分析不同 $r$ 值下的数值解行为，展示稳定和不稳定情况的对比

[不稳定情况的温度分布的3D图]
[稳定情况的温度分布的3D图]

![image](https://github.com/user-attachments/assets/bfb9e1cf-3da1-4865-bc4e-c8523e9f91aa)

![image](https://github.com/user-attachments/assets/503f731d-fdd5-4998-afa2-36cb944517bb)


### 3.4 不同初始条件模拟

[展示分段初始条件下的温度分布随时间位置演化的3D图]

![image](https://github.com/user-attachments/assets/f5acb8ab-e352-4bd5-bb47-acdd8dc936f4)

### 3.5 包含牛顿冷却定律的模拟
[展示包含牛顿冷却定律的温度分布随时间位置演化的3D图]
![image](https://github.com/user-attachments/assets/a380c548-64c0-4b9b-b6b6-db455f04f04c)

## 4. 分析与讨论

1. **稳定性问题：**
 在实现显式差分法时，当r>0.5时数值解出现剧烈振荡，原因是迭代过程中误差被放大。这是由于显式差分法的条件稳定性，当时间步长过大时，离散化后的差分方程无法满足能量守恒，导致解的发散。通过控制r≤0.5可确保每一步迭代的误差不累积，维持解的物理合理性。
2. **精度问题：**
误差来源：空间和时间离散化引入截断误差，网格越粗误差越大。
改进方法：减小Δx提高空间分辨率，但会增加计算量；减小Δt提升时间精度，但需同步满足稳定性条件；采用更高阶的差分格式（如二阶中心差分）降低截断误差

## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**
显式差分法的稳定性由特征方程的根模长决定。当r>0.5时，迭代矩阵的特征值模长大于 1，导致误差随时间指数增长。从物理角度看，过大的时间步长使得热扩散过程中能量传递超过实际物理限制，产生非物理的温度波动。


2. **如何从物理角度理解稳定性条件的含义？**
稳定性条件r≤0.5本质上要求热扩散的时间尺度与空间尺度相匹配。Δt不能超过热扩散从一个网格点传递到相邻点的特征时间，否则会导致 “信息超光速传播”，破坏物理因果性，从而引发数值不稳定。

