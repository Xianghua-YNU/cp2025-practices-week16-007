# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** 雷翊烜

**学号：** 20231130155
**完成日期：** 2025.6.15


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[在此描述你的数值方法实现，包括：]
- 空间和时间离散化方案
- 差分方程的具体形式
- 边界条件的处理方法
- 稳定性条件的考虑
需详细阐述数值方法实现，涵盖空间离散化如何划分深度网格（如确定步长、节点数）、时间离散化怎样选取时间步长与总步数；说明差分方程依据热传导原理推导的具体形式，体现热扩散在离散节点的传递；讲清时变地表边界（按给定正弦函数）和固定底部边界（恒定温度）的处理方式；还要提及为保证计算稳定，对时间步长和空间步长关系的约束（如显式差分的稳定性条件 ），完整呈现数值求解热传导问题的实现逻辑。
**稳定性分析：**

[讨论显式格式的稳定性特点，包括：]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- 时间步长选择的限制条件
讨论显式格式的稳定性特点，要说明稳定性参数 \( \text{Fo} = \frac{D\Delta t}{(\Delta z)^2} \)（这里可能题目里的 \( \text{Fo} \) 你写的格式有误，规范热传导显式差分的傅里叶数是这个形式 ，\( D \) 是热扩散率，\( \Delta t \) 是时间步长，\( \Delta z \) 是空间步长 ）的值情况，以及基于此参数，为保证数值稳定，对时间步长选择存在的限制条件，比如通常显式格式要求 \( \text{Fo} \leq 0.5 \)，意味着时间步长不能随意增大，需结合空间步长和热扩散率来合理选取，否则会出现数值解发散、不稳定的问题 。
---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数:  $n_z$ = 21 
- 时间步数:  $n_t$ = 366
- 模拟总时间：10  年
- 稳定性参数:  r = 0.1000
### 4.2 图表结果：季节性温度轮廓图
![image](https://github.com/user-attachments/assets/4ed7af6d-6a93-4263-a17e-8b91726723bf)

[在此粘贴季节性温度轮廓图图片]

**图表分析：**
- 描述四个季节温度轮廓的差异
- 分析温度振幅随深度的衰减规律
- 讨论季节性影响的穿透深度
### 图表分析
- 四个季节温度轮廓差异：Day 90（春末）地表温度高，随深度快速下降；Day 180（夏季）地表温度较高，中间深度温度变化平缓；Day 270（秋末）地表温度低，深度较小时升温明显；Day 365（冬季）地表温度低，温度随深度上升趋势缓。 
- 温度振幅随深度衰减规律：地表处振幅大（如 Day 90 与 Day 365 地表温差大），随深度增加，各曲线逐渐靠拢，振幅快速衰减，10m 后温差很小。 
- 季节性影响穿透深度：约 10 - 15m 后，季节性温度差异基本消失，可认为季节性影响穿透深度在 10 - 15m 左右，更深层受季节影响极小。 
---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

[分析模拟结果揭示的物理现象：]
模拟结果揭示：地壳热传导受地表时变温度驱动，温度随深度变化呈衰减与相位延迟，浅部受季节影响显著，深部趋于稳定，体现热扩散对周期性边界条件的响应及稳态形成过程 。

### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

   [你的回答]
 原因：热量在岩土介质中传导需时间，且岩土热扩散率低，深层热量传递慢，季节性温度变化难以快速影响到深层，故深层温度季节性变化小。
 应用：可利用深层温度相对稳定的特点，作为地源热泵的热源/热汇，实现建筑节能；也可通过分析深层温度历史变化，反演古气候，辅助研究气候变化。 
3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

   [你的回答]
显式差分格式优势是计算简单、无需解方程组，计算效率高。当对计算稳定性要求高（如大时间步长、高雷诺数场景 ），或需避免显式格式稳定性限制时，选隐式格式。
---

## 6. 核心代码片段（可选）

```python
def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366, years=10):
    """
    显式差分格式求解地壳热扩散方程核心实现
    """
    # 稳定性参数计算（显式差分关键）
    r = h * D / a**2  
    # 温度场初始化（含边界条件）
    T = np.full((M, N), T_INITIAL)
    T[-1, :] = T_BOTTOM  # 固定底部边界

    # 多年 + 逐日迭代循环（时间离散）
    for _ in range(years):
        for j in range(1, N-1):  
            # 时变地表边界条件施加
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)  
            # 内部节点显式更新（空间离散 + 差分格式）
            T[1:-1, j+1] = T[1:-1, j] + r * (T[2:, j] + T[:-2, j] - 2*T[1:-1, j])  

    # 深度网格生成
    depth = np.arange(0, DEPTH_MAX + h, h)  
    return depth, T
```

